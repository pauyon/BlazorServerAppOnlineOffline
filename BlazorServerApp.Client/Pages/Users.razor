@page "/users"
@inject IUserService UserService

<PageTitle> Users </PageTitle>

<MudStack Row="true">
    <MudText Typo="Typo.h2">Users</MudText>
    @if (!SiteConstants.IsOnline)
    {
        <MudText Typo="Typo.h4">(Offline)</MudText>
    }
</MudStack>

@if (!SiteConstants.IsOnline)
{
    <MudAlert Severity="Severity.Warning">No Internet. Data will be stored locally and will need to be synced once a connection returns.</MudAlert>
}

@if (_users == null)
{
    <MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-7" />
}
else
{
    <MudDataGrid Items="@_users" Filterable="false" SortMode="@SortMode.None" Groupable="false">
        <Columns>
            <PropertyColumn Property="x => x.Id" />
            <PropertyColumn Property="x => x.Name" />
            <PropertyColumn Property="x => x.Email" />
        </Columns>
    </MudDataGrid>
}

@code {
    private List<User>? _users;

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        _users = await UserService.GetAll(SiteConstants.IsOnline);
        StateHasChanged();
    }
}